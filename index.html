<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Lane Cove Open 2025 - Season 2</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <!-- Tailwind CSS -->
  <script src="https://cdn.tailwindcss.com"></script>
  <!-- React -->
  <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
  <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
</head>
<body class="bg-gray-100">
  <div id="root"></div>

  <script type="text/javascript">
    const { useState } = React;

    function TournamentApp() {
      const [players, setPlayers] = useState([
        "Player 1 & 2",
        "Player 3 & 4",
        "Player 5 & 6",
        "Player 7 & 8"
      ]);
      const [newPlayer, setNewPlayer] = useState("");
      const [matches, setMatches] = useState([]);
      const [roundsCount, setRoundsCount] = useState(0);

      // --- Round-robin generator ---
      function generateRoundRobin(names) {
        const n = names.length;
        if (n < 2) return [];
        const list = [...names];
        if (n % 2 === 1) list.push("BYE");
        const rounds = list.length - 1;
        const half = list.length / 2;
        let arr = [...list];
        const schedule = [];

        for (let r = 0; r < rounds; r++) {
          for (let i = 0; i < half; i++) {
            const a = arr[i], b = arr[arr.length - 1 - i];
            if (a !== "BYE" && b !== "BYE") {
              schedule.push({ round: r + 1, playerA: a, playerB: b, scoreA: "", scoreB: "", winner: null });
            }
          }
          arr = [arr[0], arr[arr.length - 1], ...arr.slice(1, -1)];
        }
        return schedule;
      }

      function handleGenerateSchedule() {
        const s = generateRoundRobin(players);
        setMatches(s);
        setRoundsCount(players.length % 2 === 0 ? players.length - 1 : players.length);
      }

      function updateMatch(idx, field, value) {
        setMatches(m =>
          m.map((x, i) => {
            if (i !== idx) return x;
            const upd = { ...x, [field]: value };
            const a = parseFloat(upd.scoreA), b = parseFloat(upd.scoreB);
            if (!isNaN(a) && !isNaN(b)) {
              if (a > b) upd.winner = upd.playerA;
              else if (b > a) upd.winner = upd.playerB;
              else upd.winner = "DRAW";
            }
            return upd;
          })
        );
      }

      function standings() {
        const table = {};
        players.forEach(p => table[p] = { name: p, played: 0, wins: 0, losses: 0, draws: 0, score: 0 });
        matches.forEach(m => {
          if (!m.winner) return;
          table[m.playerA].played++;
          table[m.playerB].played++;
          if (m.winner === m.playerA) { table[m.playerA].wins++; table[m.playerB].losses++; table[m.playerA].score += 2; }
          else if (m.winner === m.playerB) { table[m.playerB].wins++; table[m.playerA].losses++; table[m.playerB].score += 2; }
          else { table[m.playerA].draws++; table[m.playerB].draws++; table[m.playerA].score++; table[m.playerB].score++; }
        });
        return Object.values(table).sort((a,b)=> b.score - a.score || b.wins - a.wins || a.name.localeCompare(b.name));
      }

      return (
        React.createElement("div", {class:"max-w-6xl mx-auto bg-white shadow rounded-lg p-6 my-6"},
          React.createElement("h1", {class:"text-3xl font-bold mb-6 text-center"}, "Lane Cove Open 2025 - Season 2"),

          // Players Section
          React.createElement("section", {class:"mb-6"},
            React.createElement("h2", {class:"font-semibold"},"Teams"),
            React.createElement("div", {class:"flex gap-2 mt-2"},
              React.createElement("input", {
                class:"border rounded px-2 py-1 flex-1",
                placeholder:"Add team",
                value:newPlayer,
                onChange:e=>setNewPlayer(e.target.value),
                onKeyDown:e=>{ if(e.key==="Enter" && newPlayer.trim()){ setPlayers(p=>[...p,newPlayer.trim()]); setNewPlayer("") } }
              }),
              React.createElement("button", {class:"px-3 py-1 bg-blue-600 text-white rounded", onClick:()=>{if(newPlayer.trim()){ setPlayers(p=>[...p,newPlayer.trim()]); setNewPlayer("") }}}, "Add")
            ),
            React.createElement("div", {class:"mt-3 grid grid-cols-2 md:grid-cols-4 gap-2"},
              players.map((p,i)=>React.createElement("div", {key:i, class:"flex items-center gap-2 border rounded p-2"},
                React.createElement("div", {class:"flex-1"}, p),
                React.createElement("button", {class:"text-sm px-2 py-1 bg-red-500 text-white rounded", onClick:()=> setPlayers(prev=>prev.filter((_,idx)=>idx!==i))}, "Remove")
              ))
            ),
            React.createElement("div", {class:"mt-3"},
              React.createElement("button", {class:"px-3 py-1 bg-indigo-600 text-white rounded", onClick:handleGenerateSchedule}, "Generate Round-Robin")
            )
          ),

          // Matches Section
          React.createElement("section", {class:"mb-6"},
            React.createElement("h2", {class:"font-semibold"},"Matches"),
            matches.length===0
              ? React.createElement("div", {class:"text-sm text-gray-500"}, "No matches yet.")
              : Array.from({length: roundsCount}, (_,r)=> r+1).map(r =>
                  React.createElement("div", {key:r, class:"border rounded p-3 mb-2"},
                    React.createElement("div", {class:"font-medium"}, "Round " + r),
                    matches.filter(m=>m.round===r).map((m,idx)=>
                      React.createElement("div", {key:idx, class:"flex items-center gap-2 mt-2"},
                        React.createElement("div", {class:"w-40"}, m.playerA),
                        React.createElement("input", {class:"w-16 border rounded px-2", placeholder:"score", value:m.scoreA, onChange:e=>updateMatch(matches.indexOf(m),"scoreA",e.target.value)}),
                        React.createElement("span", null, "vs"),
                        React.createElement("input", {class:"w-16 border rounded px-2", placeholder:"score", value:m.scoreB, onChange:e=>updateMatch(matches.indexOf(m),"scoreB",e.target.value)}),
                        React.createElement("div", {class:"w-40"}, m.playerB),
                        m.winner && React.createElement("span", {class:"ml-2 text-green-600 text-sm"}, "Winner: " + m.winner)
                      )
                    )
                  )
                )
          ),

          // Standings Section
          React.createElement("section", null,
            React.createElement("h2", {class:"font-semibold"},"Standings"),
            React.createElement("table", {class:"w-full border mt-2"},
              React.createElement("thead", null,
                React.createElement("tr", {class:"bg-gray-100"},
                  ["Pos","Team","Played","Wins","Losses","Draws","Score"].map(h=>React.createElement("th", {class:"border px-2"}, h))
                )
              ),
              React.createElement("tbody", null,
                standings().map((s,i)=>
                  React.createElement("tr", {key:s.name, class:"odd:bg-gray-50"},
                    React.createElement("td", {class:"border px-2"}, i+1),
                    React.createElement("td", {class:"border px-2"}, s.name),
                    React.createElement("td", {class:"border px-2"}, s.played),
                    React.createElement("td", {class:"border px-2"}, s.wins),
                    React.createElement("td", {class:"border px-2"}, s.losses),
                    React.createElement("td", {class:"border px-2"}, s.draws),
                    React.createElement("td", {class:"border px-2"}, s.score)
                  )
                )
              )
            )
          )
        )
      )
    }

    ReactDOM.createRoot(document.getElementById("root")).render(React.createElement(TournamentApp));
  </script>
</body>
</html>
